<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solfeando Kids ğŸµ</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Noto+Music&display=swap" rel="stylesheet">
  
  <!-- âœ… Favicon inline para evitar 404 -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸµ</text></svg>">
  
  <!-- âœ… Howler.js desde jsDelivr -->
  <script src="https://cdn.jsdelivr.net/npm/howler@2.2.4/dist/howler.min.js"></script>
  <!-- âœ… Verovio UMD oficial para navegador -->
  <script src="https://www.verovio.org/javascript/latest/verovio-toolkit.js"></script>
  
  <!-- âœ… PolÃ­tica de seguridad actualizada -->
  <meta http-equiv="Content-Security-Policy" content="script-src 'self' https://cdn.jsdelivr.net https://www.verovio.org 'unsafe-inline';">
</head>
<body>

  <!-- PANTALLA DE INICIO -->
  <div id="inicio" class="pantalla activa">
    <h1>ğŸµ Solfeando Kids ğŸµ</h1>
    <p>Â¡Aprende mÃºsica jugando como en EarMaster, pero para niÃ±os!</p>
    <div class="botones-inicio">
      <button class="btn-modulo" onclick="irAModulo('notas')">
        <span>NOTAS MUSICALES</span>
        <div>â™ª ğ„</div>
      </button>
      <button class="btn-modulo" onclick="irAModulo('oido')">
        <span>OÃDO MÃGICO</span>
        <div>ğŸ‘‚ğŸ¶</div>
      </button>
      <button class="btn-modulo" onclick="irAModulo('ritmo')">
        <span>TALLER DE RITMO</span>
        <div>ğŸ¥â±ï¸</div>
      </button>
    </div>
  </div>

  <!-- MÃ“DULO 1: NOTAS MUSICALES -->
  <div id="notas" class="pantalla">
    <h2>ğŸ¼ NOTAS MUSICALES</h2>
    <div id="selector-clave">
      <p>Â¿En quÃ© clave quieres aprender?</p>
      <button onclick="iniciarModoAprendizaje('sol')">Clave de Sol</button>
      <button onclick="iniciarModoAprendizaje('fa')">Clave de Fa</button>
    </div>

    <div id="aprendizaje" style="display:none;">
      <div id="pentagrama-aprendizaje"></div>
      <button id="btn-jugar" onclick="iniciarTest()">Â¡A Jugar!</button>
    </div>

    <div id="test" style="display:none;">
      <div id="contador">Pregunta 1/10</div>
      <div id="pentagrama-test"></div>
      <div id="opciones-test"></div>
    </div>

    <div id="resultados" style="display:none;">
      <h3>ğŸ‰ Â¡Terminaste!</h3>
      <p id="puntuacion-final">Has acertado 0 de 10 notas.</p>
      <button onclick="repetirTest()">Repetir</button>
      <button onclick="cambiarClave()">Cambiar Clave</button>
      <button onclick="volverInicio()">MenÃº Principal</button>
    </div>
  </div>

  <!-- MÃ“DULO 2: OÃDO MÃGICO -->
  <div id="oido" class="pantalla">
    <h2>ğŸ‘‚ OÃDO MÃGICO</h2>
    <p>Escucha y elige la nota correcta</p>
    <div id="pentagrama-oido"></div>
    <div id="notas-fantasma"></div>
    <button id="btn-escuchar" onclick="reproducirNotaReferencia()">Â¡Empezar!</button>
    <div id="contador-oido">Aciertos: 0/10</div>
    <button id="btn-volver-oido" style="display:none;" onclick="volverInicio()">MenÃº Principal</button>
  </div>

  <!-- MÃ“DULO 3: TALLER DE RITMO -->
  <div id="ritmo" class="pantalla">
    <h2>ğŸ¥ TALLER DE RITMO</h2>
    <p>Completa los compases arrastrando las figuras</p>
    <div id="info-compas">CompÃ¡s: <span id="tipo-compas">4/4</span></div>
    <div id="compases-ritmo"></div>
    <div id="caja-herramientas">
      <div class="figura-musical" draggable="true" data-valor="1" title="Negra (1 tiempo)">â™©</div>
      <div class="figura-musical" draggable="true" data-valor="2" title="Blanca (2 tiempos)">ğ…—ğ…¥</div>
      <div class="figura-musical" draggable="true" data-valor="0.5" title="Corchea (0.5 tiempos)">â™ª</div>
      <div class="figura-musical" draggable="true" data-valor="1" title="Silencio de negra">ğ„½</div>
    </div>
    <button id="btn-reproducir-ritmo" style="display:none;" onclick="reproducirRitmo()">Â¡Reproducir Ritmo!</button>
    <button onclick="nuevoRitmo()" style="margin-top:20px;">Nuevo Ritmo</button>
    <button onclick="volverInicio()" style="margin-top:10px;">MenÃº Principal</button>
  </div>

  <!-- âœ… Script.js al final - como mÃ³dulo -->
  <script type="module" src="script.js"></script>
</body>
</html>